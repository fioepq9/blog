---
title: 【高性能MySQL】- 第3章 服务器性能剖析
date: 2022-04-28 16:08:14
tags:
  - 阅读笔记
  - MySQL
  - 高性能MySQL
categories:
  - 数据库
  - MySQL
---

## 性能的定义

完成某件任务所需要的时间度量，即响应时间。

### 性能优化是什么？

在一定的工作负载下尽可能地降低响应时间。

## 性能剖析是什么？

性能剖析是测量和分析时间花费在哪里的主要方法。一般有两个步骤：

+ 测量任务所花费的时间。
+ 对结果进行统计和排序，将重要的任务排在前面。

### 性能剖析的类型

存在两种类型的性能剖析：

+ **基于执行时间的分析**：研究的是什么任务的执行时间最长。
+ **基于等待的分析**：判断任务在什么地方被阻塞的时间最长。

如果不能确定问题是出在执行还是等待，那么两种方式都需要试试。

## 剖析服务器负载

### 捕获 MySQL 的查询到日志文件中

+ 慢查询日志
+ 通用日志

### 分析查询日志

找出最差的查询。

## 剖析单条查询

+ `SHOW PROFILE`

`SHOW PROFILE`命令是在 MySQL 5.1 以后的版本中引入的。

默认是禁用的，但可以通过服务器变量在会话级别动态地修改。

+ `SHOW STATUS`

MySQL  的 `SHOW STATUS` 命令返回一些计数器。既有服务器级别的全局计数器，也有基于某个连接的会话级别的计数器。

+ 慢查询日志
+ `Performance Schema`

## 其他剖析工具

+ `USER_STATISTICS` 表
+ `strace`

